## L9 Action2

召回阶段：基于用户画像及场景数据从海量的item（百万级别）中将相关度最高的资源检索出来，作为候选集。粗糙的召回候选item。从百万级召回到百级。采用的近似最近邻查找,提升效率
     
排序阶段，相比召回阶段，引入了更多的feature。基于更加精细的特征对候选集（百级别）进行排序，最终呈现给用户的是很少的一部分数据。

在召回阶段的DNN模型中，整个模型架构是包含三个隐层的DNN结构。输入是用户浏览历史、搜索历史、人口统计学信息和其余上下文信息concat成的输入向量。将用户点击购买观看历史和搜索历史通过embedding的方式映射成为一个稠密的向量，同时用户场景信息以及用户画像信息（比如年龄，性别等离散特征）也被归一化到[0,1]作为DNN的输入。采用的经典的“tower”模式搭建网络，所有的item和search token都embedded到256维的向量中，开始input层直接全连接到256维的softmax层，依次增加网络深度。输出分线上和离线训练两个部分。离线训练阶段输出层为softmax层，是一个“超大规模多分类”问题。即在时刻t，为用户U（上下文信息C）在item库中精准的预测出具体item的类别（每个具体的item为一个类别，i即为一个类别）。

排序阶段模型和召回阶段基本类似，特征工程中最重要的Signal是描述用户与商品本身或相似商品之间交互的Signal。排序阶段精准的预估用户对item的喜好程度。针对数百个item，需要更多feature来描述item，以及user-item的关系。针对具体的应用场景，模型的输出层可能不是简单的点击购买等，也可能是浏览观看时长，消费规模等等，所以要将评估标准作为权重加入到模型中，比如采用Weighted Logistic Regression。排序阶段输出精排几百个到十几个，最终推荐给用户。



